{"version":3,"sources":["webpack:///webpack/bootstrap 4ab17fdaa9b2ea46e22b","webpack:///external \"mongoose\"","webpack:///external \"koa-router\"","webpack:///./server/config.js","webpack:///external \"cuid\"","webpack:///./server/controllers/base.js","webpack:///./server/index.js","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///./server/mongodb/index.js","webpack:///./server/middlewares.js","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-json\"","webpack:///./server/routes/index.js","webpack:///./server/routes/api.js","webpack:///./server/routes/children/project.js","webpack:///./server/controllers/project.js","webpack:///external \"fs\"","webpack:///external \"simple-git/promise\"","webpack:///./server/const.js","webpack:///./server/mongodb/models/project.js","webpack:///./server/mongodb/schemas/project.js","webpack:///./server/mongodb/models/backup.js","webpack:///./server/mongodb/schemas/backup.js","webpack:///./server/routes/children/user.js","webpack:///./server/controllers/user.js","webpack:///./server/mongodb/models/user.js","webpack:///./server/mongodb/schemas/user.js","webpack:///./server/routes/children/role.js","webpack:///./server/controllers/role.js","webpack:///./server/mongodb/models/role.js","webpack:///./server/mongodb/schemas/role.js","webpack:///./server/mongodb/models/module.js","webpack:///./server/mongodb/schemas/module.js","webpack:///./nuxt.config.js","webpack:///external \"autoprefixer\"","webpack:///./server/routes/children/module.js","webpack:///./server/controllers/module.js"],"names":["app","name","version","server","port","static","root","options","mongodb","url","account","password","session","secretKey","BaseController","constructor","id","host","process","env","HOST","PORT","config","isProd","nuxtConfig","require","dev","nuxt","builder","build","middlewares","use","router","routes","ctx","next","status","Promise","resolve","reject","res","on","render","req","promise","then","catch","listen","mongoose","connect","db","connection","err","console","log","once","headersSent","throw","body","data","type","message","emit","bodyParser","Router","api","allowedMethods","project","user","role","module","get","ProjectController","find","findOne","post","save","remove","findBackUp","updateBackup","initRepo","git","remote","init","addRemote","findRepoBranch","path","fs","existsSync","mkdirSync","inst","all","current","checkIsRepo","isRepo","branch","branchList","params","requestBody","request","cuid","Project","findOneAndUpdate","new","upsert","query","content","RegExp","map","_","_doc","number","total","size","totalElements","Backup","projectId","backupId","backup","$set","projects","backups","date","model","Schema","String","unique","createTime","Date","UserController","avatar","User","description","level","Number","modules","parentId","RoleController","moduleIds","split","Module","$in","Role","exports","middleware","head","title","meta","charset","hid","link","rel","href","vendor","babel","plugins","libraryName","styleLibraryName","loaders","test","loader","limit","postcss","browsers","HOST_URL","loading","color","css","src","lang","ModuleController","parenId"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4ab17fdaa9b2ea46e22b","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 1\n// module chunks = 0","export default {\r\n  app: {\r\n    name: 'demo',\r\n    version: '1.0.0'\r\n  },\r\n  server: {\r\n    port: 3000\r\n  },\r\n  static: {\r\n    root: './static',\r\n    options: {}\r\n  },\r\n  mongodb: {\r\n    name: 'test',\r\n    url: 'mongodb://localhost:27017/test',\r\n    account: 'chris',\r\n    password: '123456'\r\n  },\r\n  session: {\r\n    secretKey: '123'\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/config.js","module.exports = require(\"cuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cuid\"\n// module id = 3\n// module chunks = 0","class BaseController {\r\n\tconstructor ({id}) {\r\n\t\tthis.id = id\r\n\t}\r\n}\r\n\r\nexport default BaseController\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/base.js","import Koa from 'koa'\r\nimport {Nuxt, Builder} from 'nuxt'\r\nimport './mongodb'\r\nimport config from './config'\r\nimport middlewares from './middlewares'\r\nimport router from './routes'\r\n\r\nconst app = new Koa()\r\n\r\nconst host = process.env.HOST || '127.0.0.1'\r\nconst port = process.env.PORT || config.server.port\r\nconst isProd = process.env.NODE_ENV === 'production'\r\n\r\nlet nuxtConfig = require('../nuxt.config')\r\nnuxtConfig.dev = !(app.env === 'production')\r\n\r\nconst nuxt = new Nuxt(nuxtConfig)\r\n\r\nif (nuxtConfig.dev) {\r\n  const builder = new Builder(nuxt)\r\n  builder.build()\r\n}\r\n\r\nmiddlewares(app)\r\napp.use(router.routes())\r\napp.use(async (ctx, next) => {\r\n  ctx.status = 200\r\n  return new Promise((resolve, reject) => {\r\n    ctx.res.on('close', resolve)\r\n    ctx.res.on('finish', resolve)\r\n    nuxt.render(ctx.req, ctx.res, promise => {\r\n      promise.then(resolve).catch(reject)\r\n    })\r\n  })\r\n})\r\napp.listen(port, host)\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 7\n// module chunks = 0","import mongoose from 'mongoose'\r\nimport config from '../config'\r\n\r\nmongoose.connect(config.mongodb.url)\r\nconst db = mongoose.connection\r\n\r\ndb.on('error', err => {\r\n  console.log('数据库连接失败：' + err)\r\n})\r\ndb.once('open', () => {\r\n  console.log('数据库连接成功')\r\n})\r\ndb.on('disconnected', () => {\r\n  console.log('数据哭连接断开')\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/index.js","import bodyParser from 'koa-bodyparser'\r\nimport json from 'koa-json'\r\nimport config from './config'\r\n\r\nexport default (app) => {\r\n  app.use(async (ctx, next) => {\r\n    try {\r\n      await next()\r\n      if (ctx.status === 404 && ctx.res.headersSent === false) {\r\n        ctx.throw(404)\r\n      }\r\n      if (ctx.status === 200 && ctx.res.headersSent === false) {\r\n        ctx.body = {\r\n          status: 200,\r\n          data: ctx.body\r\n        }\r\n      }\r\n    } catch (err) {\r\n      ctx.status = err.status || 500\r\n      ctx.type = 'json'\r\n      ctx.body = {\r\n        status: ctx.status,\r\n        message: err.message\r\n      }\r\n      ctx.app.emit('error', err, ctx)\r\n    }\r\n  })\r\n  app.use(bodyParser())\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/middlewares.js","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"koa-json\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-json\"\n// module id = 11\n// module chunks = 0","import Router from 'koa-router'\r\nimport api from './api'\r\nconst router = Router()\r\n\r\nrouter.use('/api', api.routes(), api.allowedMethods())\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/index.js","import Router from 'koa-router'\r\nimport project from './children/project'\r\nimport user from './children/user'\r\nimport role from './children/role'\r\nimport module from './children/module'\r\nconst router = Router()\r\n\r\nrouter.use('/project', project.routes(), project.allowedMethods())\r\nrouter.use('/user', user.routes(), user.allowedMethods())\r\nrouter.use('/role', role.routes(), role.allowedMethods())\r\nrouter.use('/module', module.routes(), module.allowedMethods())\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/api.js","import Router from 'koa-router'\r\nimport ProjectController from '../../controllers/project'\r\nconst router = Router()\r\n\r\nrouter.get('/list', ProjectController.find)\r\nrouter.get('/get', ProjectController.findOne)\r\nrouter.post('/save', ProjectController.save)\r\nrouter.post('/delete/:id', ProjectController.remove)\r\nrouter.get('/backup/list', ProjectController.findBackUp)\r\nrouter.post('/backup/update', ProjectController.updateBackup)\r\nrouter.get('/build', ProjectController.updateBackup)\r\n// router.get('/build', async (ctx, next) => {\r\n//   ctx.type = 'json'\r\n//   let {id} = ctx.query\r\n//   let message\r\n//   const project = projects.find(_ => _.id === id)\r\n//   try {\r\n//     const inst = git(`./projects/${project.id}`)\r\n//     // init reposity\r\n//     await inst.checkIsRepo()\r\n//       .then(isRepo => !isRepo && initRepo(inst, project.url))\r\n//       .then(() => inst.fetch())\r\n//       // .then(() => inst.pull('origin', 'develop'))\r\n//     message = await inst.branch()\r\n//   }\r\n//   catch (e) {\r\n//     console.error('failed: ', e)\r\n//     message = 'error'\r\n//   }\r\n//   ctx.body = message\r\n// })\r\n\r\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/children/project.js","import fs from 'fs'\r\nimport git from 'simple-git/promise'\r\nimport cuid from 'cuid'\r\nimport {backups} from '../const'\r\nimport Project from '../mongodb/models/project'\r\nimport Backup from '../mongodb/models/backup'\r\nimport BaseController from './base'\r\n\r\nconst initRepo = (git, remote) => git.init().then(() => git.addRemote('origin', remote))\r\nconst findRepoBranch = async project => {\r\n  const path = `./projects/${project.id}`\r\n  if (!fs.existsSync(path)) {\r\n    fs.mkdirSync(path)\r\n  }\r\n  const inst = git(path)\r\n  let {all, current} = await inst.checkIsRepo()\r\n    .then(isRepo => !isRepo && initRepo(inst, project.url))\r\n    .then(() => inst.branch())\r\n  return {\r\n    ...project,\r\n    current,\r\n    branchList: all\r\n  }\r\n}\r\n\r\nclass ProjectController extends BaseController {\r\n  constructor (params) {  \r\n    super(params)\r\n  }\r\n  // 保存项目信息\r\n  static async save(ctx, next) {\r\n    let requestBody = ctx.request.body\r\n    let {id, name, url} = requestBody\r\n    id = id || cuid()\r\n    let data = await Project.findOneAndUpdate({id}, {id, name, url}, {new: true, upsert: true})\r\n    ctx.body = data\r\n  }\r\n  // 删除项目信息\r\n  static async remove(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await Project.remove({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取项目信息\r\n  static async findOne(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await Project.findOne({id})\r\n    ctx.body = res\r\n  }\r\n  // 获取项目列表\r\n  static async find(ctx, next) {\r\n    let {name = ''} = ctx.query\r\n    let content = await Project.find({name: new RegExp(name)})\r\n    content = await Promise.all(content.map(_ => findRepoBranch(_._doc)))\r\n    ctx.body = {\r\n      content,\r\n      number: 1,\r\n      total: 1,\r\n      size: 10,\r\n      totalElements: 10\r\n    }\r\n  }\r\n  // 获取项目备份列表\r\n  static async findBackUp(ctx, next) {\r\n    let {id} = ctx.query\r\n    let content = await Backup.find({projectId: id})\r\n    ctx.body = {\r\n      content,\r\n      number: 1,\r\n      total: 1,\r\n      size: 10,\r\n      totalElements: 10\r\n    }\r\n  }\r\n  static async updateBackup (ctx, next) {\r\n    let requestBody = ctx.request.body\r\n    let {id, backupId} = requestBody\r\n    let backup = await Backup.findOne({id: backupId, projectId: id})\r\n    let res = await Project.findOneAndUpdate({id}, {$set: { backup }})\r\n    ctx.body = res\r\n  }\r\n}\r\n\r\nexport default ProjectController\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/project.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"simple-git/promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"simple-git/promise\"\n// module id = 17\n// module chunks = 0","export const projects = [\r\n  {id: '1', name: 'tvi-trace-oa', url: 'https://gitee.com/tvi-center/tvi-trace-oa'},\r\n  {id: '2', name: 'tvi-trace-admin', url: 'https://gitee.com/tvi-center/tvi-trace-admin'}\r\n]\r\n\r\nexport const backups = [\r\n  {id: '1', name: '2018-01-27', date: '2018-01-27'},\r\n  {id: '2', name: '2018-01-28', date: '2018-01-28'}\r\n]\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/const.js","import mongoose from 'mongoose'\r\nimport ProjectSchema from '../schemas/project'\r\n\r\nconst Project = mongoose.model('Project', ProjectSchema)\r\n\r\nexport default Project\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/models/project.js","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst Project = new Schema({\r\n\tid: {type: String, unique: true},\r\n\tname: {type: String},\r\n\turl: {type: String},\r\n\tbackup: {\r\n\t\tid: String,\r\n\t\tname: String,\r\n\t\tcreateTime: Date\r\n\t}\r\n})\r\n\r\nexport default Project\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/schemas/project.js","import mongoose from 'mongoose'\r\nimport BackupSchema from '../schemas/backup'\r\n\r\nconst Backup = mongoose.model('Backup', BackupSchema)\r\n\r\nexport default Backup\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/models/backup.js","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst Backup = new Schema({\r\n  id: {type: String, unique: true},\r\n  projectId: {type: String},\r\n  name: {type: String},\r\n  branch: {\r\n    id: String,\r\n    name: String\r\n  },\r\n\tcreateTime: {type: Date}\r\n})\r\n\r\nexport default Backup\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/schemas/backup.js","import Router from 'koa-router'\r\nimport UserController from '../../controllers/user'\r\nconst router = Router()\r\n\r\nrouter.get('/list', UserController.find)\r\nrouter.get('/get/:id', UserController.findOne)\r\nrouter.post('/save', UserController.save)\r\nrouter.post('/delete/:id', UserController.remove)\r\n\r\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/children/user.js","import cuid from 'cuid'\r\nimport User from '../mongodb/models/user'\r\nimport BaseController from './base'\r\n\r\nclass UserController extends BaseController {\r\n  constructor (params) {  \r\n    super(params)\r\n\r\n    this.account = params.account\r\n    this.password = params.password\r\n  }\r\n  // 保存用户信息\r\n  static async save(ctx, next) {\r\n    let requestBody = ctx.request.body\r\n    let {id, name, avatar} = requestBody\r\n    id = id || cuid()\r\n    let res = await User.findOneAndUpdate({id}, {id, name, avatar}, {new: true, upsert: true})\r\n    ctx.body = res\r\n  }\r\n  // 删除用户信息\r\n  static async remove(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await User.remove({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取用户信息\r\n  static async findOne(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await User.findOne({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取用户列表\r\n  static async find(ctx, next) {\r\n    let {name} = ctx.query\r\n    let content = await User.find({name: new RegExp(name)})\r\n    ctx.body = {\r\n      content,\r\n      number: 1,\r\n      total: 1,\r\n      size: 10,\r\n      totalElements: 10\r\n    }\r\n  }\r\n}\r\n\r\nexport default UserController\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/user.js","import mongoose from 'mongoose'\r\nimport UserSchema from '../schemas/user'\r\n\r\nconst User = mongoose.model('User', UserSchema)\r\n\r\nexport default User\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/models/user.js","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst User = new Schema({\r\n\tid: {type: String, unique: true},\r\n\taccount: {type: String},\r\n\tpassword: {type: String},\r\n\tavatar: {type: String},\r\n\tname: {type: String},\r\n\trole: {\r\n\t\tid: String,\r\n\t\tname: String,\r\n\t\tdescription: String,\r\n\t\tlevel: Number,\r\n\t\tmodules: [{\r\n\t\t\tid: String,\r\n\t\t\tparentId: String,\r\n\t\t\tname: String,\r\n\t\t\tdescription: String\r\n\t\t}]\r\n\t}\r\n})\r\n\r\nexport default User\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/schemas/user.js","import Router from 'koa-router'\r\nimport RoleController from '../../controllers/role'\r\nconst router = Router()\r\n\r\nrouter.get('/list', RoleController.find)\r\nrouter.get('/get/:id', RoleController.findOne)\r\nrouter.post('/save', RoleController.save)\r\nrouter.post('/delete/:id', RoleController.remove)\r\n\r\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/children/role.js","import cuid from 'cuid'\r\nimport Role from '../mongodb/models/role'\r\nimport Module from '../mongodb/models/module'\r\nimport BaseController from './base'\r\n\r\nclass RoleController extends BaseController {\r\n  constructor (params) {  \r\n    super(params)\r\n  }\r\n  // 保存角色信息\r\n  static async save(ctx, next) {\r\n    let requestBody = ctx.request.body\r\n    let {id, name, description, level, moduleIds = ''} = requestBody\r\n    id = id || cuid()\r\n    moduleIds = moduleIds ? moduleIds.split(',') : []\r\n    let modules = await Module.find({\r\n      id: { $in: moduleIds }\r\n    })\r\n    let res = await Role.findOneAndUpdate({id}, {id, name, description, level, modules}, {new: true, upsert: true})\r\n    ctx.body = res\r\n  }\r\n  // 删除角色信息\r\n  static async remove(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await Role.remove({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取角色信息\r\n  static async findOne(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await Role.findOne({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取角色列表\r\n  static async find(ctx, next) {\r\n    let {name} = ctx.query\r\n    let content = await Role.find({name: new RegExp(name)})\r\n    ctx.body = {\r\n      content,\r\n      number: 1,\r\n      total: 1,\r\n      size: 10,\r\n      totalElements: 10\r\n    }\r\n  }\r\n}\r\n\r\nexport default RoleController\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/role.js","import mongoose from 'mongoose'\r\nimport RoleSchema from '../schemas/role'\r\n\r\nconst Role = mongoose.model('Role', RoleSchema)\r\n\r\nexport default Role\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/models/role.js","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst Role = new Schema({\r\n\tid: {type: String, unique: true},\r\n  name: {type: String},\r\n  description: {type: String},\r\n  level: {type: Number},\r\n  modules: [{\r\n    id: String,\r\n    parentId: String,\r\n    name: String,\r\n    description: String\r\n  }]\r\n})\r\n\r\nexport default Role\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/schemas/role.js","import mongoose from 'mongoose'\r\nimport ModuleSchema from '../schemas/module'\r\n\r\nconst Module = mongoose.model('Module', ModuleSchema)\r\n\r\nexport default Module\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/models/module.js","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst Module = new Schema({\r\n  id: {type: String, unique: true},\r\n  parentId: {type: String},\r\n  name: {type: String},\r\n  description: {type: String}\r\n})\r\n\r\nexport default Module\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongodb/schemas/module.js","module.exports = {\r\n  router: {\r\n    middleware: 'auth'\r\n  },\r\n  head: {\r\n    title: 'nuxt-element-demo',\r\n    meta: [\r\n      { charset: 'utf-8' },\r\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\r\n      { hid: 'description', name: 'description', content: 'Nuxt.js + element-ui DEMO' }\r\n    ],\r\n    link: [\r\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\r\n    ]\r\n  },\r\n  build: {\r\n    vendor: [\r\n      'element-ui', 'axios'\r\n    ],\r\n    babel: {\r\n      plugins: [\r\n        ['component', [{\r\n          libraryName: 'element-ui',\r\n          styleLibraryName: 'theme-chalk'\r\n        }]],\r\n        'transform-decorators-legacy'\r\n      ]\r\n    },\r\n    loaders: [\r\n      {\r\n        test: /\\.scss$/,\r\n        loaders: ['style', 'css', 'sass']\r\n      },\r\n      {\r\n        test: /\\.(png|jpe?g|gif|svg)$/,\r\n        loader: 'url-loader',\r\n        query: {\r\n          limit: 1000,\r\n          name: 'img/[name].[hash:7].[ext]'\r\n        }\r\n      },\r\n      {\r\n        test: /\\.(woff2?|eot|ttf|otf)(\\?.*)?$/,\r\n        loader: 'url-loader',\r\n        query: {\r\n          limit: 1000,\r\n          name: 'fonts/[name].[hash:7].[ext]'\r\n        }\r\n      }\r\n    ],\r\n    postcss: [\r\n      require('autoprefixer')({\r\n        browsers: ['last 3 versions']\r\n      })\r\n    ]\r\n  },\r\n  env: {\r\n    HOST_URL: process.env.HOST_URL || 'http://127.0.0.1:3000'\r\n  },\r\n  loading: { color: '#3B8070' },\r\n  css: [\r\n    'element-ui/lib/theme-chalk/index.css',\r\n    { src: '~assets/css/index.scss', lang: 'scss' },\r\n    { src: '~assets/css/reset.scss', lang: 'scss' }\r\n  ],\r\n  plugins: [\r\n    '~plugins/element-ui'\r\n  ]\r\n}\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = require(\"autoprefixer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"autoprefixer\"\n// module id = 34\n// module chunks = 0","import Router from 'koa-router'\r\nimport ModuleController from '../../controllers/module'\r\nconst router = Router()\r\n\r\nrouter.get('/list', ModuleController.find)\r\nrouter.get('/get/:id', ModuleController.findOne)\r\nrouter.post('/save', ModuleController.save)\r\nrouter.post('/delete/:id', ModuleController.remove)\r\n\r\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/children/module.js","import cuid from 'cuid'\r\nimport Module from '../mongodb/models/module'\r\nimport BaseController from './base'\r\n\r\nclass ModuleController extends BaseController {\r\n  constructor (params) {  \r\n    super(params)\r\n  }\r\n  // 保存模块信息\r\n  static async save(ctx, next) {\r\n    let requestBody = ctx.request.body\r\n    let {id, parenId, name, description} = requestBody\r\n    id = id || cuid()\r\n    let res = await Module.findOneAndUpdate({id}, {id, parenId, name, description}, {new: true, upsert: true})\r\n    ctx.body = res\r\n  }\r\n  // 删除模块信息\r\n  static async remove(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await Module.remove({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取模块信息\r\n  static async findOne(ctx, next) {\r\n    let {id} = ctx.params\r\n    let res = await Module.findOne({ id })\r\n    ctx.body = res\r\n  }\r\n  // 获取模块列表\r\n  static async find(ctx, next) {\r\n    let {name} = ctx.query\r\n    let content = await Module.find({name: new RegExp(name)})\r\n    ctx.body = {\r\n      content,\r\n      number: 1,\r\n      total: 1,\r\n      size: 10,\r\n      totalElements: 10\r\n    }\r\n  }\r\n}\r\n\r\nexport default ModuleController\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/module.js"],"sourceRoot":""}